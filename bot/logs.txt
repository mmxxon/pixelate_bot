INFO:aiogram.dispatcher:Start polling
INFO:aiogram.dispatcher:Run polling for bot @pixelate_edit_bot id=7361163424 - 'Pixelate Bot'
INFO:aiogram.event:Update id=238755494 is handled. Duration 732 ms by bot id=7361163424
INFO:aiogram.event:Update id=238755495 is handled. Duration 220 ms by bot id=7361163424
INFO:aiogram.event:Update id=238755496 is not handled. Duration 8 ms by bot id=7361163424
ERROR:aiogram.event:Cause exception while process update id=238755496 by bot id=7361163424
TelegramNetworkError: HTTP Client says - ClientConnectionError: Failed to send bytes into the underlying connection Connection<ConnectionKey(host='api.telegram.org', port=443, is_ssl=True, ssl=True, proxy=None, proxy_auth=None, proxy_headers_hash=None)>
Traceback (most recent call last):
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/client_reqrep.py", line 658, in write_bytes
    await self.body.write(writer)
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/multipart.py", line 1008, in write
    await part.write(writer)
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/payload.py", line 494, in write
    chunk = await self._iter.__anext__()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/types/input_file.py", line 103, in read
    async with aiofiles.open(self.path, "rb") as f:
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiofiles/base.py", line 63, in __aenter__
    return await self
           ^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiofiles/base.py", line 59, in __await__
    self._obj = yield from self._coro.__await__()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiofiles/threadpool/__init__.py", line 92, in _open
    f = await loop.run_in_executor(executor, cb)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
TypeError: expected str, bytes or os.PathLike object, not BytesIO

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/client/session/aiohttp.py", line 181, in make_request
    async with session.post(
               ~~~~~~~~~~~~^
        url, data=form, timeout=self.timeout if timeout is None else timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ) as resp:
    ^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/client.py", line 730, in _request
    await resp.start(conn)
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/client_reqrep.py", line 1059, in start
    message, payload = await protocol.read()  # type: ignore[union-attr]
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/streams.py", line 671, in read
    await self._waiter
aiohttp.client_exceptions.ClientConnectionError: Failed to send bytes into the underlying connection Connection<ConnectionKey(host='api.telegram.org', port=443, is_ssl=True, ssl=True, proxy=None, proxy_auth=None, proxy_headers_hash=None)>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/home/last/work/XR_course/pixelate_bot/bot/controllers/pixelate_controller.py", line 110, in pixel_back_to_main_callback
    await callback.message.edit_media(
    ...<2 lines>...
    )
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/methods/base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/client/bot.py", line 498, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/client/session/base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/client/session/aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientConnectionError: Failed to send bytes into the underlying connection Connection<ConnectionKey(host='api.telegram.org', port=443, is_ssl=True, ssl=True, proxy=None, proxy_auth=None, proxy_headers_hash=None)>
INFO:aiogram.event:Update id=238755497 is handled. Duration 158 ms by bot id=7361163424
INFO:aiogram.event:Update id=238755498 is not handled. Duration 8 ms by bot id=7361163424
ERROR:aiogram.event:Cause exception while process update id=238755498 by bot id=7361163424
TelegramNetworkError: HTTP Client says - ClientConnectionError: Failed to send bytes into the underlying connection Connection<ConnectionKey(host='api.telegram.org', port=443, is_ssl=True, ssl=True, proxy=None, proxy_auth=None, proxy_headers_hash=None)>
Traceback (most recent call last):
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/client_reqrep.py", line 658, in write_bytes
    await self.body.write(writer)
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/multipart.py", line 1008, in write
    await part.write(writer)
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/payload.py", line 494, in write
    chunk = await self._iter.__anext__()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/types/input_file.py", line 103, in read
    async with aiofiles.open(self.path, "rb") as f:
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiofiles/base.py", line 63, in __aenter__
    return await self
           ^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiofiles/base.py", line 59, in __await__
    self._obj = yield from self._coro.__await__()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiofiles/threadpool/__init__.py", line 92, in _open
    f = await loop.run_in_executor(executor, cb)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
TypeError: expected str, bytes or os.PathLike object, not BytesIO

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/client/session/aiohttp.py", line 181, in make_request
    async with session.post(
               ~~~~~~~~~~~~^
        url, data=form, timeout=self.timeout if timeout is None else timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ) as resp:
    ^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/client.py", line 730, in _request
    await resp.start(conn)
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/client_reqrep.py", line 1059, in start
    message, payload = await protocol.read()  # type: ignore[union-attr]
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiohttp/streams.py", line 671, in read
    await self._waiter
aiohttp.client_exceptions.ClientConnectionError: Failed to send bytes into the underlying connection Connection<ConnectionKey(host='api.telegram.org', port=443, is_ssl=True, ssl=True, proxy=None, proxy_auth=None, proxy_headers_hash=None)>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/home/last/work/XR_course/pixelate_bot/bot/controllers/pixelate_controller.py", line 70, in pixel_preview_callback
    await callback.message.edit_media(
    ...<2 lines>...
    )
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/methods/base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/client/bot.py", line 498, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/client/session/base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/last/.virtualenvs/pixelate_bot-eook/lib/python3.13/site-packages/aiogram/client/session/aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientConnectionError: Failed to send bytes into the underlying connection Connection<ConnectionKey(host='api.telegram.org', port=443, is_ssl=True, ssl=True, proxy=None, proxy_auth=None, proxy_headers_hash=None)>
INFO:aiogram.event:Update id=238755499 is handled. Duration 125 ms by bot id=7361163424
INFO:aiogram.event:Update id=238755500 is handled. Duration 50 ms by bot id=7361163424
INFO:aiogram.event:Update id=238755501 is handled. Duration 65 ms by bot id=7361163424
WARNING:aiogram.dispatcher:Received SIGINT signal
INFO:aiogram.dispatcher:Polling stopped for bot @pixelate_edit_bot id=7361163424 - 'Pixelate Bot'
INFO:aiogram.dispatcher:Polling stopped
